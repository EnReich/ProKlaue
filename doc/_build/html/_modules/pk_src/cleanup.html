<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>pk_src.cleanup &mdash; ProKlaue 0.2.8 documentation</title>
    
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../',
        VERSION:     '0.2.8',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="top" title="ProKlaue 0.2.8 documentation" href="../../index.html" />
    <link rel="up" title="Module code" href="../index.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for pk_src.cleanup</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Command cmds.cleanup</span>
<span class="sd">Find and list all shells of currently selected &#39;transform&#39; node in GUI. One shell can be selected and extracted (all other shells and their mesh components will be deleted). Additionally the tubes building faces can be found (orthogonal distance from center point of triangle needs to be smaller than specified threshold). Primarily handles all the user interaction inside maya and processes output of commands &#39;getShells&#39; and &#39;findTubeFaces&#39;.</span>

<span class="sd">Args:</span>
<span class="sd">    obj : string with object&#39;s name inside maya</span>
<span class="sd">    threshold (t): threshold of orthogonal distance between two triangles to determine vessel tube</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">maya.OpenMayaMPx</span> <span class="kn">as</span> <span class="nn">OpenMayaMPx</span>
<span class="kn">import</span> <span class="nn">maya.OpenMaya</span> <span class="kn">as</span> <span class="nn">om</span>
<span class="kn">import</span> <span class="nn">maya.api.OpenMaya</span> <span class="kn">as</span> <span class="nn">om2</span>
<span class="kn">import</span> <span class="nn">maya.cmds</span> <span class="kn">as</span> <span class="nn">cmds</span>
<span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">partial</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">operator</span>
<span class="kn">import</span> <span class="nn">misc</span>

<span class="k">class</span> <span class="nc">cleanup</span><span class="p">(</span><span class="n">OpenMayaMPx</span><span class="o">.</span><span class="n">MPxCommand</span><span class="p">):</span>
    <span class="n">windowID</span> <span class="o">=</span> <span class="s1">&#39;wCleanup&#39;</span>
    <span class="n">obj</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">shells</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">OpenMayaMPx</span><span class="o">.</span><span class="n">MPxCommand</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__cancelCallback</span><span class="p">(</span><span class="o">*</span><span class="n">pArgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">windowID</span><span class="p">,</span> <span class="n">exists</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">deleteUI</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">windowID</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__updateProgress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">Tprogress</span><span class="p">,</span> <span class="n">case</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Handle different states of progress text element of GUI to inform about current calculations and interaction possibilities.</span>

<span class="sd">        @param Tprogress: Maya cmds.text() object pointing to GUI-element</span>
<span class="sd">        @param case: integer value specifying the text to be printed</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Processing...&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Press &#39;Find&#39; to calculate shells&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">2</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Click on a shell to view selection&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">3</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Press &#39;Select&#39; to remove all other shells&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">4</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Finished!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">5</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;No object selected!&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">6</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Faces selected! Delete to remove.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">case</span> <span class="o">==</span> <span class="mi">7</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Fill holes and triangulate...&#39;</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">f</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__findFacesCallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FFthreshold</span><span class="p">,</span> <span class="n">Tprogress</span><span class="p">,</span> <span class="o">*</span><span class="n">pArgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback function for GUI to find faces in tubes with current threshold parameter.</span>

<span class="sd">        @param FFthreshold: Maya cmds.floatField() object pointing to GUI-element with threshold value</span>
<span class="sd">        @param Tprogress: Maya cmds.text() object pointing to GUI-element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="n">cmds</span><span class="o">.</span><span class="n">floatField</span><span class="p">(</span><span class="n">FFthreshold</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">Tprogress</span><span class="p">}</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">findTubeFaces</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__applySelectCallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SLlist</span><span class="p">,</span> <span class="n">Tprogress</span><span class="p">,</span> <span class="o">*</span><span class="n">pArgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback function for select button in GUI to extract currently selected shell.</span>

<span class="sd">        @param SLlist: Maya cmds.textScrollsList() object pointing to GUI-element with listed shells</span>
<span class="sd">        @param Tprogress: Maya cmds.text() object pointing to GUI-element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">SLlist</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">selectItem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
            <span class="c1"># split given string into shells index to reference shell nested list</span>
            <span class="n">index</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">:])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No shell selected!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">shell_indices</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># save all indices of not selected shell in list</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">shells</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">i</span> <span class="o">!=</span> <span class="n">index</span><span class="p">):</span>
                <span class="n">shell_indices</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="c1"># delete all faces in list</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">shell_indices</span><span class="p">)):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">delete</span><span class="p">([</span> <span class="n">cleanup</span><span class="o">.</span><span class="n">obj</span> <span class="o">+</span> <span class="s2">&quot;.f[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">shell_indices</span><span class="p">])</span>
        <span class="c1"># clear selection and remove item from scrollList</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">clear</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">SLlist</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">removeAll</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
        <span class="c1"># fill possible holes and retriangulate polygon</span>
        <span class="c1">#cmds.polyCloseBorder(cleanup.obj)</span>
        <span class="c1">#cmds.polyTriangulate(cleanup.obj)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__applyScrollCallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">SLlist</span><span class="p">,</span> <span class="n">Tprogress</span><span class="p">,</span> <span class="o">*</span><span class="n">pArgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Callback to update user selection from scrollList.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="c1"># get selected item in scrollList as string</span>
        <span class="n">item</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">SLlist</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">selectItem</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
        <span class="c1"># split string into shells index and extract substring to reference shell nested list by its index</span>
        <span class="n">item</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">5</span><span class="p">:])</span>
        <span class="k">print</span><span class="p">(</span><span class="s2">&quot;select Shell&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">select</span><span class="p">([</span> <span class="n">cleanup</span><span class="o">.</span><span class="n">obj</span> <span class="o">+</span> <span class="s2">&quot;.f[&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cleanup</span><span class="o">.</span><span class="n">shells</span><span class="p">[</span><span class="n">item</span><span class="p">]])</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__applyCallback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">FFthreshold</span><span class="p">,</span> <span class="n">SLlist</span><span class="p">,</span> <span class="n">Tprogress</span><span class="p">,</span> <span class="o">*</span><span class="n">pArgs</span><span class="p">):</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">SLlist</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">removeAll</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="n">options</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="n">cmds</span><span class="o">.</span><span class="n">floatField</span><span class="p">(</span><span class="n">FFthreshold</span><span class="p">,</span> <span class="n">q</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;p&#39;</span><span class="p">:</span><span class="n">Tprogress</span><span class="p">}</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">cleanup</span><span class="p">(</span><span class="o">**</span><span class="n">options</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No &#39;transform&#39; object selected!&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">shells</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">shells</span><span class="p">):</span>
                <span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">SLlist</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">append</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Shell&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; (&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">])</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">SLlist</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sc</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__applyScrollCallback</span><span class="p">,</span> <span class="n">SLlist</span><span class="p">,</span> <span class="n">Tprogress</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__updateProgress</span><span class="p">(</span><span class="n">Tprogress</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">createUI</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">pArgs</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">windowID</span><span class="p">,</span> <span class="n">exists</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">deleteUI</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">windowID</span><span class="p">)</span>
        <span class="c1"># initialize window properties</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">window</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">windowID</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;cleanupUI&#39;</span><span class="p">,</span> <span class="n">sizeable</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">resizeToFitChildren</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">columnLayout</span><span class="p">(</span><span class="n">columnAttach</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">columnWidth</span> <span class="o">=</span> <span class="mi">265</span><span class="p">)</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">rowLayout</span><span class="p">(</span><span class="n">numberOfColumns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">columnWidth3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Threshold:&#39;</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
        <span class="n">threshold</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">floatField</span><span class="p">(</span><span class="n">visible</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">minValue</span> <span class="o">=</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">pre</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">step</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">)</span>
        <span class="n">findFacesButton</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;findFaces&#39;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">70</span> <span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">rowLayout</span><span class="p">(</span><span class="n">numberOfColumns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">columnWidth1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">250</span><span class="p">))</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;List of shells with number of triangles:&#39;</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">230</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">rowLayout</span><span class="p">(</span><span class="n">numberOfColumns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">columnWidth1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">250</span><span class="p">))</span>
        <span class="n">scrollList</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">textScrollList</span><span class="p">(</span><span class="n">width</span> <span class="o">=</span> <span class="mi">250</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">rowLayout</span><span class="p">(</span><span class="n">numberOfColumns</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">columnWidth1</span> <span class="o">=</span> <span class="p">(</span><span class="mi">250</span><span class="p">))</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;Press &#39;Find&#39; to calculate shells&quot;</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">200</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">findFacesButton</span><span class="p">,</span> <span class="n">e</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__findFacesCallback</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">progress</span><span class="p">))</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">rowLayout</span><span class="p">(</span><span class="n">numberOfColumns</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">columnWidth3</span> <span class="o">=</span> <span class="p">(</span><span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Find&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__applyCallback</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">scrollList</span><span class="p">,</span> <span class="n">progress</span><span class="p">),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">70</span> <span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Select&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__applySelectCallback</span><span class="p">,</span> <span class="n">scrollList</span><span class="p">,</span> <span class="n">progress</span><span class="p">),</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">button</span><span class="p">(</span><span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Cancel&#39;</span><span class="p">,</span> <span class="n">command</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cancelCallback</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="mi">70</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s1">&#39;center&#39;</span><span class="p">)</span>
        <span class="n">cmds</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="s1">&#39;..&#39;</span><span class="p">)</span>

        <span class="n">cmds</span><span class="o">.</span><span class="n">showWindow</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">doIt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argList</span><span class="p">):</span>
        <span class="c1"># get only the first object from argument list</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">cleanup</span><span class="o">.</span><span class="n">obj</span> <span class="o">=</span> <span class="n">misc</span><span class="o">.</span><span class="n">getArgObj</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">syntax</span><span class="p">(),</span> <span class="n">argList</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">warning</span><span class="p">(</span><span class="s2">&quot;No object selected!&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">cmds</span><span class="o">.</span><span class="n">objectType</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">obj</span><span class="p">)</span> <span class="o">!=</span> <span class="s1">&#39;transform&#39;</span><span class="p">):</span>
            <span class="n">cmds</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Object is not of type transform!&quot;</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="n">argData</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">MArgParser</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">syntax</span><span class="p">(),</span> <span class="n">argList</span><span class="p">)</span>
        <span class="n">progress</span> <span class="o">=</span> <span class="n">argData</span><span class="o">.</span><span class="n">flagArgumentString</span><span class="p">(</span><span class="s1">&#39;progress&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="k">if</span> <span class="p">(</span><span class="n">argData</span><span class="o">.</span><span class="n">isFlagSet</span><span class="p">(</span><span class="s1">&#39;progress&#39;</span><span class="p">))</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>

        <span class="n">cleanup</span><span class="o">.</span><span class="n">shells</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># get list of strings with shell indices and cast them to regular integer lists</span>
        <span class="n">lShells</span> <span class="o">=</span> <span class="n">cmds</span><span class="o">.</span><span class="n">getShells</span><span class="p">(</span><span class="n">cleanup</span><span class="o">.</span><span class="n">obj</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">progress</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">lShells</span><span class="p">:</span>
            <span class="n">cleanup</span><span class="o">.</span><span class="n">shells</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">int</span><span class="p">,</span> <span class="n">sep</span> <span class="o">=</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

<span class="c1"># creator function</span>
<div class="viewcode-block" id="cleanupCreator"><a class="viewcode-back" href="../../pk_src.cleanup.html#pk_src.cleanup.cleanupCreator">[docs]</a><span class="k">def</span> <span class="nf">cleanupCreator</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">OpenMayaMPx</span><span class="o">.</span><span class="n">asMPxPtr</span><span class="p">(</span> <span class="n">cleanup</span><span class="p">()</span> <span class="p">)</span></div>

<span class="c1"># syntax creator function</span>
<div class="viewcode-block" id="cleanupSyntaxCreator"><a class="viewcode-back" href="../../pk_src.cleanup.html#pk_src.cleanup.cleanupSyntaxCreator">[docs]</a><span class="k">def</span> <span class="nf">cleanupSyntaxCreator</span><span class="p">():</span>
    <span class="n">syntax</span> <span class="o">=</span> <span class="n">om</span><span class="o">.</span><span class="n">MSyntax</span><span class="p">()</span>
    <span class="n">syntax</span><span class="o">.</span><span class="n">setObjectType</span><span class="p">(</span><span class="n">om</span><span class="o">.</span><span class="n">MSyntax</span><span class="o">.</span><span class="n">kStringObjects</span><span class="p">)</span>
    <span class="n">syntax</span><span class="o">.</span><span class="n">addFlag</span><span class="p">(</span><span class="s2">&quot;t&quot;</span><span class="p">,</span> <span class="s2">&quot;threshold&quot;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">MSyntax</span><span class="o">.</span><span class="n">kDouble</span><span class="p">)</span>
    <span class="n">syntax</span><span class="o">.</span><span class="n">addFlag</span><span class="p">(</span><span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="s2">&quot;progress&quot;</span><span class="p">,</span> <span class="n">om</span><span class="o">.</span><span class="n">MSyntax</span><span class="o">.</span><span class="n">kString</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">syntax</span></div>

<span class="c1"># create button for shelf</span>
<div class="viewcode-block" id="addButton"><a class="viewcode-back" href="../../pk_src.cleanup.html#pk_src.cleanup.addButton">[docs]</a><span class="k">def</span> <span class="nf">addButton</span><span class="p">(</span><span class="n">parentShelf</span><span class="p">):</span>
    <span class="n">cmds</span><span class="o">.</span><span class="n">shelfButton</span><span class="p">(</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parentShelf</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="s1">&#39;pythonFamily.png&#39;</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">cleanup</span><span class="p">()</span><span class="o">.</span><span class="n">createUI</span><span class="p">,</span> <span class="n">imageOverlayLabel</span> <span class="o">=</span> <span class="s1">&#39;clean&#39;</span><span class="p">,</span> <span class="n">ann</span><span class="o">=</span><span class="s1">&#39;clean current selection by removing holes&#39;</span><span class="p">)</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Enrico Reich.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.4.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.7</a>
      
    </div>

    

    
  </body>
</html>